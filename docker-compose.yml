# Environment variables loaded from .env file - see .env.example for required vars
services:
  backend-flask:
    env_file:
      - .env
    build: ./backend-flask
    ports:
      - "5000:5000"
    volumes:
      - ./backend-flask:/backend-flask
    networks:
      - internal-network

  frontend-react-js:
    env_file:
      - .env
    build: ./frontend-react-js
    ports:
      - "3000:3000"
    volumes:
      - ./frontend-react-js:/frontend-react-js
      - /frontend-react-js/node_modules
    networks:
      - internal-network


  # dynamodb-local:
  #   user: root
  #   command: "-jar DynamoDBLocal.jar  -sharedDb -dbPath ./data"
  #   image: amazon/dynamodb-local
  #   container_name: dynamodb-local
  #   ports:
  #     - "8000:8000"
  #   volumes:
  #     - "./docker/dynamodb:/home/dynamodblocal/data"
  #   working_dir: /home/dynamodblocal

  db:
    image: postgres:13-alpine
    restart: always
    env_file:
      - .env
    ports:
      - "5432:5432"
    volumes:
      - db:/var/lib/postgresql/data


  xray-daemon:
    image: amazon/aws-xray-daemon
    env_file:
      - .env
    command:
      - "xray -o -b xray-daemon:2000"
    ports:
      - 2000:2000/udp
    networks:
      - internal-network





networks:
  internal-network:
    driver: bridge
    name: cruddur

# volumes:
#   db:
#     driver: local
