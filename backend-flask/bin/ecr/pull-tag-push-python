#!/usr/bin/env bash
set -e  # stop script on error

AWS_REGION="eu-west-2"
ACCOUNT_ID="225442939245"
ECR_URL="$ACCOUNT_ID.dkr.ecr.$AWS_REGION.amazonaws.com"
IMAGE_NAME="cruddur-python"
IMAGE_TAG="3.11-slim-buster"



echo "=== Pulling base Python image ==="
docker pull python:$IMAGE_TAG

echo "=== Tagging image for ECR ==="
docker tag python:$IMAGE_TAG $ECR_URL/$IMAGE_NAME:$IMAGE_TAG



echo "=== Done ==="
echo "Image tag:"
echo "  $ECR_URL/$IMAGE_NAME:$IMAGE_TAG"



echo "=== Pushing to ECR ==="
docker push $ECR_URL/$IMAGE_NAME:$IMAGE_TAG
echo "=== Push completed ==="


